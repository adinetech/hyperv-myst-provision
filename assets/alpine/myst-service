#!/sbin/openrc-run

while true
do
    if [ -f /.env.myst ]; then
      break
    fi
    sleep 5
done
source /.env.myst

name="Mysterium Network Node"
command="myst"
command_args="--keystore.lightweight service --agreed-terms-and-conditions wireguard --launcher.ver=$LAUNCHER"
command_background=true
pidfile="/run/${RC_SVCNAME}.pid"

depend() {
        need net
}

start_pre() {
    while true
    do
        l=`find /root/.mysterium/keystore -type f | wc -l`
        if [ $l -ge 2 ]
        then
          logger Keystore found..
          break
        fi
        echo Waiting for keystore..
        sleep 5
    done
}
